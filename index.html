<!DOCTYPE html>
<html ng-app="app" ng-controller="main">
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<script src="http://cdn.jsdelivr.net/g/jquery@1,jquery.ui@1.10%28jquery.ui.core.min.js+jquery.ui.widget.min.js+jquery.ui.mouse.min.js+jquery.ui.sortable.min.js%29,angularjs@1.2,angular.ui-sortable"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.0/js/ngDialog.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.20/angular-route.min.js"></script>
		<script src="//cdn.jsdelivr.net/angular.dragdrop/1.07/angular-dragdrop.min.js"></script>
		<script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/sha256.js"></script>
		<script src="js/settings.js"></script>
		<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/pure-min.css">
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.0/css/ngDialog-theme-default.min.css">
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.0/css/ngDialog-theme-plain.min.css">
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.0/css/ngDialog.min.css">
		<link rel="stylesheet" href="css/style.css">
		<title>{{menuTitle}}</title>
	</head>
	<body>
		<div id="divMenu" class="pure-menu pure-menu-open pure-menu-horizontal">
			<a class="pure-menu-heading" href="#">{{menuTitle}}</a>
			<ul>
				<li ng-show="loggedIn" ng-click="onCreateProjectClick()"><a href="#">Create project</a></li>
			</ul>
			<ul class="menu-right">
				<li ng-hide="loggedIn" ng-click="onLoginClick()"><a href="#">Login</a></li>
				<li ng-hide="loggedIn" ng-click="onSignupClick()"><a href="#">Sign Up</a></li>
				<li ng-show="loggedIn" ng-click="onLogoutClick()"><a href="#">Logout</a></li>
			</ul>
		</div>
		<div id="divContent" class="pure-u-11-12">
			
			<div ng-repeat="project in projects">
				<button class="pure-button" ng-click="onCreateItemChildClick(project)">Create item for {{project._id.$oid}}</button>
				<ul ui-sortable="sortableOptions" ng-model="project.items">
					<li ng-repeat="item in project.items" 
						ng-init="parentItems = project.items; parentItem = project"
						ng-include="'templateProjectItem'" >
					</li>
				</ul>
				<br>
			</div>


			<p>Number of times loaded: {{numLoaded}}</p>
		</div>
		<script type="text/ng-template" id="templateProjectItem">
			<span ng-click="onCreateItemClick(project, item)">
				{{item.description}}
			</span>
			<button ng-click="onCreateItemSiblingClick(project, item, parentItems[$index+1])">Create next sibling</button>
			<button ng-click="onCreateItemSiblingClick(project, parentItems[$index-1], item)">Create previous sibling</button>
			<button ng-click="onCreateItemChildClick(project, item)">Create child</button>
			<ul ng-model="parentItem.items" ng-init="parentItem = item" ui-sortable="sortableOptions">
				<li ng-repeat="item in item.items" 
					ng-init="parentItems = parentItem.items" 
					ng-include="'templateProjectItem'">
				</li>
			</ul>
		</script>
		<script type="text/ng-template" id="templateSignup">
			<form class="pure-form pure-form-stacked" ng-submit="onSignupSubmit()">
			    <fieldset>
			        <legend>Sign up</legend>

					<label for="name">Name</label>
			        <input ng-model="user.name" id="name" type="text" placeholder="Name">

			        <label for="email">Email</label>
			        <input ng-model="user.email" id="email" type="email" placeholder="Email">

			        <label for="password">Password</label>
			        <input ng-model="user.password" id="password" type="password" placeholder="Password">

			        <label for="password2">Password</label>
			        <input ng-model="user.password2" id="password2" type="password" placeholder="Repeat password">

			        <label for="remember" class="pure-checkbox">
			            <input ng-model="remember" id="remember" type="checkbox"> Remember me
			        </label>

			        <button type="submit" class="pure-button pure-button-primary">Sign up</button>
			    </fieldset>
			</form>
		</script>
		<script type="text/ng-template" id="templateLogin">
			<form class="pure-form pure-form-stacked" ng-submit="onLoginSubmit()">
			    <fieldset>
			        <legend>Login</legend>

			        <label for="email">Email</label>
			        <input ng-model="user.email" id="email" type="email" placeholder="Email">

			        <label for="password">Password</label>
			        <input ng-model="user.password" id="password" type="password" placeholder="Password">

			        <label for="remember" class="pure-checkbox">
			            <input ng-model="remember" id="remember" type="checkbox"> Remember me
			        </label>

			        <button type="submit" class="pure-button pure-button-primary">Login</button>
			    </fieldset>
			</form>
		</script>
		<script type="text/ng-template" id="templateProject">
			<form class="pure-form pure-form-stacked" ng-submit="onProjectSubmit()">
			    <fieldset>
			        <legend>Create project</legend>

			        <label for="name">Name</label>
			        <input ng-model="project.name" id="name" type="text" placeholder="Name">

					<label for="priority">Priority</label>
			        <input class="pure-input-1-4" ng-init="project.priority=1" ng-model="project.priority" id="priority" type="number" placeholder="Priority">

			        <label for="category">Category</label>
			        <select ng-init="project.category='Work'" ng-model="project.category" id="category">
			        	<option>Work</option>
			        	<option>Private</option>
			        </select>

			        <button type="submit" class="pure-button pure-button-primary">Create</button>
			    </fieldset>
			</form>
		</script>
		<script type="text/ng-template" id="templateItem">
			<form class="pure-form pure-form-stacked" ng-submit="onCreateItemSubmit()">
			    <fieldset>
			        <legend>Create item</legend>

			        <label for="description">Description</label>
			        <textarea class="pure-input-1" rows="2" ng-model="item.description" id="description" type="text" placeholder="Description" autofocus>
			        </textarea>

					<label for="priority">Priority</label>
			        <input class="pure-input-1-4" ng-init="item.priority=1" ng-model="item.priority" id="priority" type="number" placeholder="Priority">

			        <button type="submit" class="pure-button pure-button-primary">Create</button>
			    </fieldset>
			</form>
		</script>
	</body>
	<script src="js/app.js"></script>
	<script src="js/main.js"></script>
	<script src="js/db.js"></script>	
	<script src="js/popup.js"></script>
</html>